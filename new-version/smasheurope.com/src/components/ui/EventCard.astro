---
import LinkButton from './LinkButton.astro';
import EventImage from './EventImage.astro';
import getDateFormatted from "@utils/getDateFormatted";
import Button from './Button.astro';
const { event } = Astro.props;

// Get the dates info and formatting
const startDate = new Date(event.dates[0]);
const endDate = new Date(event.dates[1]);

const dates = {
  startDate: getDateFormatted(startDate),
  endDate: getDateFormatted(endDate),
}

// compile dates to a string for easy rendering
const datesStr = `
    ${dates.startDate.month} ${dates.startDate.day}${dates.startDate.suffix}-${dates.endDate.day}${dates.endDate.suffix}
    ${dates.endDate.month !== dates.startDate.month ? dates.endDate.month : ''}`
---
<div class="bg-white h-full rounded-lg p-8 shadow-md">
  <div class="flex min-h-full flex-col justify-start">
    <span class="flex basis-full leading-none mb-3 items-center justify-center text-se-dark text-base font-semibold">
      {event.games}
    </span>
    <div class="flex basis-full">
      <EventImage imagePath=`${event.banner}` alt=`${event.title} banner` />
    </div>

    <div class="flex items-center py-2 leading-relaxed space-x-1">
      <span class="inline-block align-middle text-2xl font-bold text-se-dark leading-relaxed">
        {event.title}
      </span>
      {event.subtitle &&
        <div class="flex items-center text-sm space-x-2">
          <span class="relative flex items-center h-full font-bold text-2xl align-middle leading-tight -top-1/8">:</span> 
          <span class="relative flex align-middle text-base font-normal top-0.5">
            {event.subtitle}
          </span>
        </div>
      }
    </div>
    <div class="flex grow min-h-32">
      <p set:html={event.description} class="text-se-muted text-m text-justify leading-relaxed" />
    </div>
    
    <!-- <Fragment >
      
    </Fragment> -->
    
    <div class="flex basis-full py-3 text-sm">
      <span class="text-se-dark">{datesStr}</span>
      <span>{`, ${event.location.municipality}, ${event.location.country}`}</span>
    </div>
    
    <div class="grid grid-cols-3 gap-3">
      <div class="col-span-2 flex space-x-2">
        <Button icon="trailer" />
        <LinkButton icon="tournament" url={event.details} newTab={true} />
      </div>
      <LinkButton icon="info" url={`/events/${event.id}`} classes="justify-self-end"/>
    </div>
  </div>
</div>
